{% extends "base.html" %}
{% block title %}Dashboard - Interview Prep{% endblock %}
{% block content %}
<div class="dashboard-header">
    <h1>Interview Prep</h1>
    <div class="stats-row">
        <div class="stat-card">
            <span class="stat-value">{{ progress.daily_streak }}</span>
            <span class="stat-label">Day Streak</span>
        </div>
        <div class="stat-card">
            <span class="stat-value">{{ progress.total_attempted }}</span>
            <span class="stat-label">Attempted</span>
        </div>
        <div class="stat-card">
            <span class="stat-value">{{ progress.total_correct }}</span>
            <span class="stat-label">Correct</span>
        </div>
        {% if due_count > 0 %}
        <a href="/review" class="stat-card stat-due">
            <span class="stat-value">{{ due_count }}</span>
            <span class="stat-label">Due for Review</span>
        </a>
        {% endif %}
    </div>
</div>

<div class="module-grid">
    {% for item in modules %}
    <div class="module-card">
        <div class="module-card-header">
            <span class="module-number">{{ '%02d' % item.module.number }}</span>
            <h2 class="module-title">{{ item.module.title }}</h2>
        </div>
        <p class="module-subtitle">{{ item.module.subtitle }}</p>
        <div class="module-categories">
            {% for cat in item.categories %}
            <span class="category-tag cat-{{ cat }}">{{ cat }}</span>
            {% endfor %}
        </div>
        <div class="progress-bar-container">
            <div class="progress-bar" style="width: {{ item.progress.completion_pct }}%"></div>
            <span class="progress-text">{{ item.progress.completion_pct }}%</span>
        </div>
        <div class="module-stats">
            <span>{{ item.progress.sections_viewed|length }}/{{ item.module.sections|length }} sections</span>
            <span>{{ item.questions_attempted }}/{{ item.questions_total }} questions</span>
        </div>
        <div class="module-actions">
            <a href="/module/{{ item.module.id }}" class="btn btn-primary">Study</a>
            <a href="/module/{{ item.module.id }}/quiz" class="btn btn-secondary">Quiz</a>
            <a href="/module/{{ item.module.id }}/flashcards" class="btn btn-ghost">Cards</a>
        </div>
        {% if item.progress.completion_pct > 0 %}
        <form method="POST" action="/api/progress/{{ item.module.id }}/reset" class="reset-form">
            <button type="submit" class="btn btn-ghost btn-sm" onclick="return confirm('Reset all progress for this module?')">Reset</button>
        </form>
        {% endif %}
    </div>
    {% endfor %}
</div>
{% endblock %}
